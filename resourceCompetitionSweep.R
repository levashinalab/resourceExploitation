## The within host dynamics are given by a simple model of competition for resources between eggs and parasites. #####

#remove old values to avoid trouble
rm(list=ls())

### define firectory
OUT_DIR <-paste("~/Documents/Projects/Malaria/resourceExplotaition/results/", Sys.Date(), "/",sep = "")
ifelse(!dir.exists(OUT_DIR), dir.create(OUT_DIR), FALSE)


##### 2. define steady states for within-host ----
E_steady_c<-function(params)
{
  with(as.list(params), {
    E<-(K_E-alpha_2*K_P)/(1-alpha_1*alpha_2)
    return(E)
  })
}

E_steady_p<-function(params)
{
  with(as.list(params), {
    E<-(K_E-alpha_2*K_P)/(1+alpha_1*alpha_2)
    return(E)
  })
}


P_steady_c<-function(params)
{
  with(as.list(params), {
    P<-(K_P-alpha_1*K_E)/(1-alpha_1*alpha_2)
    return(P)
  })
}

P_steady_p<-function(params)
{
  with(as.list(params), {
    P<-(K_P+alpha_1*K_E)/(1+alpha_1*alpha_2)
    return(P)
  })
}




#### Determine the steady states for several values of alpha_1 and alpha_2, i.e., for the interaction strength of the parasite with the eggs (how strong does it compete for resources, or scavenges the resources)----

alpha_1_vector<-seq(0,1,by=0.01)
alpha_2_vector<-seq(0,1,by = 0.01)

competition.df<-c()
parasitism.df<-c()

for(i in alpha_1_vector)
{
  print(i)
  for(j in alpha_2_vector)
  {
    params<-c(alpha_1 = i, alpha_2 = j, K_E = 1, K_P = 1)
    tmp<-data.frame(E_steady_c(params), P_steady_c(params), i, j,"competition")
    tmp2<-data.frame(E_steady_p(params), P_steady_p(params), i, j,"parasitism")
    
    ifelse(i==-1,competition.df<-tmp,competition.df<-rbind(competition.df,tmp))
    ifelse(i==-1,parasitism.df<-tmp2,parasitism.df<-rbind(parasitism.df,tmp2))
  }

}

names(competition.df)<-c("Eggs", "Parasite", "alpha_1","alpha_2","model")
names(parasitism.df)<-c("Eggs", "Parasite","alpha_1","alpha_2","model")


###save the results -----
write.table(competition.df, file = paste(OUT_DIR, "lotkaVolterraCompetition.txt", sep = ""), sep = "\t", row.names = FALSE)
write.table(parasitism.df, file = paste(OUT_DIR, "lotkaVolterraParasitism.txt", sep = ""), sep = "\t", row.names = FALSE)


