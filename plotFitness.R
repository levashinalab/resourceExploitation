#### This script plots the results (heatmaps) of the within vector simulation models######

#remove old values to avoid trouble
rm(list=ls())

##load all necessary libraries
library(ggplot2)
library(matrixStats)
library(directlabels)
library(viridis)
source('~/Documents/Projects/Malaria/modeling/ABM/src/RScripts/ggplotThemes.R')

#define model----
MODEL<-"lotkaVolterraCompetition" #name of the model
TYPE = "saturating"


if(TYPE == "linear")
{
  MAX = 120
  MAX_V = 1.2
}
if(TYPE == "saturating")
{
  MAX = 230
  MAX_V = 0.8
}


### define directories----
IN_DIR <-paste("~/Documents/Projects/Malaria/resourceExplotaition/results/", Sys.Date(), "/", sep="")

IN_DIR <-"~/Documents/Projects/Malaria/resourceExplotaition/results/2018-05-29/"


if(!dir.exists(IN_DIR))stop("Directory could not be found!")

OUT_DIR <-paste(IN_DIR, "figures/",sep = "")
ifelse(!dir.exists(OUT_DIR), dir.create(OUT_DIR), FALSE)

IN_FILE<-paste(IN_DIR, MODEL, "_",TYPE,"_fitness.txt", sep ="")
OUT_FILE<-paste(OUT_DIR , MODEL,"_",TYPE, "_fitness.pdf", sep = "")
OUT_FILE_V<-paste(OUT_DIR , MODEL,"_",TYPE, "_virulence.pdf", sep = "")

## read the files ----
df.competition<-read.table(IN_FILE, sep="\t", header = TRUE)

r0<-ggplot(df.competition, aes(x = alpha2, y = alpha1, z = fitness, fill = fitness)) + geom_tile()+scale_fill_viridis( na.value="white", name = expression(R[0]), limits = c(0,MAX)) +  theme_bw() +  labs(x=expression(alpha[2]), y=expression(alpha[1])) +stat_contour(color = "white") +paos_theme

virulence<-ggplot(df.competition, aes(x = alpha2, y = alpha1, z = virulence, fill = virulence)) + geom_tile()+scale_fill_viridis(na.value="white", name = expression(nu[h]), limits = c(0,MAX_V)) +  theme_bw() +  labs(x=expression(alpha[2]), y=expression(alpha[1])) +stat_contour(color = "white") +paos_theme

pdf(OUT_FILE, width = 8, height = 6, bg = "transparent")
r0
dev.off()

pdf(OUT_FILE_V, width = 8, height = 6, bg = "transparent")
virulence
dev.off()