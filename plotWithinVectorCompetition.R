#### This script plots the results (heatmaps) of the within vector simulation models######

#remove old values to avoid trouble
rm(list=ls())

##load all necessary libraries
library(ggplot2)
library(matrixStats)
library(directlabels)
source('~/Documents/Projects/Malaria/modeling/ABM/src/RScripts/ggplotThemes.R')

#define model----
MODEL<-"lotkaVolterraParasitism" #name of the model

### define directories----
IN_DIR <-paste("~/Documents/Projects/Malaria/resourceExplotaition/results/", Sys.Date(), "/", sep="")

#IN_DIR <-"~/Documents/Projects/Malaria/resourceExplotaition/results/2018-02-26/old_functionalResponse/"


if(!dir.exists(IN_DIR))stop("Directory could not be found!")

OUT_DIR <-paste(IN_DIR, "figures/",sep = "")
ifelse(!dir.exists(OUT_DIR), dir.create(OUT_DIR), FALSE)

IN_FILE<-paste(IN_DIR, MODEL, ".txt", sep ="")
OUT_FILE<-paste(OUT_DIR , MODEL, ".pdf", sep = "")

## read the files ----
df.competition<-read.table(IN_FILE, sep="\t", header = TRUE)

eggs<-ggplot(df.competition, aes(x = alpha_2, y = alpha_1, z = Eggs, fill = Eggs)) + geom_tile()+scale_fill_distiller(palette="Spectral", na.value="white", name = expression(bar(E)))+  theme_bw() +  labs(x=expression(alpha[2]), y=expression(alpha[1])) + theme_set(theme_bw(base_size = 24)) +theme(strip.background = element_rect(colour = "white", fill = "white"), legend.text=element_text(size=24)) +stat_contour(color = "white")

parasite<-ggplot(df.competition, aes(x = alpha_2, y = alpha_1, z = Parasite, fill = Parasite)) + geom_tile()+scale_fill_distiller(palette="Spectral", na.value="white", name = expression(bar(P)))+  theme_bw() +  labs(x=expression(alpha[2]), y=expression(alpha[1])) + theme_set(theme_bw(base_size = 24)) +theme(strip.background = element_rect(colour = "white", fill = "white"), legend.text=element_text(size=24)) +stat_contour(color = "white")



gridExtra::grid.arrange(eggs,parasite)

pdf(OUT_FILE, width = 5, height = 9)
gridExtra::grid.arrange(eggs, parasite)
dev.off()
